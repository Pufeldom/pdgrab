---
---
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>items</title>
    <style>
        ul { padding-left: 0; margin-left: 0; }
        ul li { padding-left: 0; margin-left: 20px; display: inline-block; list-style-type: none; }
        table { border-collapse: collapse; }
        table td { padding: 5px; border: 1px solid #777; }
        table tr:nth-child(2n+1) { background-color: #eee; }
        img { border-width: 0; height: 50px; vertical-align: top; }
    </style>
</head>
<body>

<ul>
    <li><a href="https://github.com/thybzi/pdgrab/new/master/" id="new-link" target="_blank">NEW ITEM</a></li>
    <li><a href="bitrix.csv" download="bitrix_{{ site.time | date:'%Y%m%d_%H%M' }}.csv">bitrix.csv</a></li>
    <li><a href="youla.xml" download="youla_{{ site.time | date:'%Y%m%d_%H%M' }}.xml">youla.xml</a></li>
</ul>

<table>
{% assign items = site.items | sort:"slug" | reverse %}{% for item in items %}
    <tr>
        <td>{{ item.slug }}</td>
        <td><a href="https://github.com/thybzi/pdgrab/edit/master/{{ item.path }}">{{ item.title }}</a></td>
        <td><a href="https://github.com/thybzi/pdgrab/edit/master/{{ item.path }}"><img src="{{ item.image }}"></a></td>
    </tr>
{% endfor %}
</table>

<template id="new">---
hru: Символьный код (можно пустой)
title: Название товара
price: 4200
section: Пуфы
color: Красный
shape: Прямоугольный
width: 900
depth: 400
height: 450
material: Велюр
legs: Пластик
martindale: Тест Мартиндейла
density: Плотность ткани
weight: Вес в кг
pmurl: Поле "Link" c postimages.org
image: Поле "Direct link" c postimages.org
gallery:
  - Первая картинка, поле "Direct link" c postimages.org
  - Вторая картинка, поле "Direct link" c postimages.org
  - и т.д., можно добавлять/удалять строки (в т.ч. удалить все)
new: true
active: true
---

Описание товара.
Можно многострочное.
</template>
{% assign prefix = 'g' %}{% assign prefix_len = prefix | size %}
<script>
(() => {
    const prefix = '{{ prefix }}';
    const maxIndex = [{% for item in site.items %}{% assign head = item.slug | slice:0,prefix_len %}{% if head == prefix %}
        '{{ item.slug }}',{% endif %}{% endfor %}
    ].reduce((maxIndex, filename) => {
        const itemIndex = parseInt(filename.substring(prefix.length), 10);
        return Math.max(itemIndex, maxIndex);
    }, 0);
    const path = `_items/${prefix}${('0000' + (maxIndex + 1)).slice(-4)}.html`;
    const content = document.getElementById('new').innerHTML;
    document.getElementById('new-link').href += `?filename=${encodeURIComponent(path)}&value=${encodeURIComponent(content)}`;
})();
</script>

</body>
</html>
